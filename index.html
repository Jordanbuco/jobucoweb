<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MIWEB</title>
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" type="text/css"
        href="https://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>

<body>
    <div id="navr"></div>
    <main id="main-content"></main>

    <!-- Botón fijo en la esquina superior derecha -->
    <button class="fixed-button" onclick="togglePasswordDialog()">+</button>

    <!-- Overlay que cubre toda la pantalla -->
    <div class="overlay" id="overlay" onclick="togglePasswordDialog()" style="display:none;"></div>

    <!-- Cuadro de diálogo para ingresar -->
    <div class="password-dialog" id="password-dialog" style="display:none;">
        <h2>Acceder a la página:</h2>

        <!-- Campo de entrada para la contraseña -->
        <input type="password" id="password-input" placeholder="Ingresa la contraseña">
        
        <button type="button" onclick="checkPassword()">Ingresar</button>
        <button type="button" onclick="togglePasswordDialog()">Cancelar</button>

        <!-- Mensaje de error para contraseña incorrecta -->
        <p id="error-message" style="color: red; display: none;">Contraseña incorrecta, intenta de nuevo.</p>
    </div>

    <script>
        // Cargar los componentes del navr y del main de forma independiente
        const components = [
            { id: 'navr', file: 'com/navr.html' }
        ];

        components.forEach(component => {
            fetch(component.file)
                .then(response => response.text())
                .then(html => {
                    document.getElementById(component.id).innerHTML = html;

                    // Añadir eventos para expandir el menú después de cargarlo
                    const navr = document.querySelector('.main-menu');
                    const mainContent = document.getElementById('main-content');

                    navr.addEventListener('mouseenter', function () {
                        navr.classList.add('expanded-menu');
                    });

                    navr.addEventListener('mouseleave', function () {
                        navr.classList.remove('expanded-menu');
                    });
                })
                .catch(error => console.error('Error al cargar componente:', component.id, error));
        });

        // Función para cargar contenido dinámico en el main
        function loadContent(page) {
            fetch(page)
                .then(response => response.text())
                .then(html => {
                    document.getElementById('main-content').innerHTML = html;

                    // Reiniciar Alpine.js después de cargar el contenido
                    Alpine.initTree(document.getElementById('main-content'));
                })
                .catch(error => console.error('Error al cargar página:', page, error));
        };

        // Al iniciar, cargar la página Home por defecto
        document.addEventListener('DOMContentLoaded', function () {
            loadContent('com/home.html');
        });

        // Función para mostrar/ocultar el cuadro de diálogo de ingreso y el overlay
        function togglePasswordDialog() {
            const dialog = document.getElementById('password-dialog');
            const overlay = document.getElementById('overlay');
            
            if (dialog.style.display === 'none' || dialog.style.display === '') {
                dialog.style.display = 'block';
                overlay.style.display = 'block';
            } else {
                dialog.style.display = 'none';
                overlay.style.display = 'none';
            }
        }

        // Función para verificar la contraseña
        function checkPassword() {
            const inputPassword = document.getElementById('password-input').value;

            fetch('private/password.json')  // Reemplazar con la URL correcta del archivo JSON
                .then(response => response.json())
                .then(data => {
                    const correctPassword = data.password;  // El servidor debe devolver { "password": "1111" }

                    if (inputPassword === correctPassword) {
                        goToAddMedia();  // Si la contraseña es correcta, redirigir
                    } else {
                        document.getElementById('error-message').style.display = 'block';  // Mostrar mensaje de error
                    }
                })
                .catch(error => console.error('Error al obtener la contraseña:', error));
        }

        // Función para redirigir a la página de agregar medios
        function goToAddMedia() {
            loadContent('com/addmedia.html');
            togglePasswordDialog();  // Ocultar el cuadro de diálogo después de redirigir
        }
    </script>
</body>

</html><!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MIWEB</title>
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" type="text/css"
        href="https://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>

<body>
    <div id="navr"></div>
    <main id="main-content"></main>

    <!-- Botón fijo en la esquina superior derecha -->
    <button class="fixed-button" onclick="togglePasswordDialog()">+</button>

    <!-- Overlay que cubre toda la pantalla -->
    <div class="overlay" id="overlay" onclick="togglePasswordDialog()" style="display:none;"></div>

    <!-- Cuadro de diálogo para ingresar -->
    <div class="password-dialog" id="password-dialog" style="display:none;">
        <h2>Acceder a la página:</h2>

        <!-- Campo de entrada para la contraseña -->
        <input type="password" id="password-input" placeholder="Ingresa la contraseña">
        
        <button type="button" onclick="checkPassword()">Ingresar</button>
        <button type="button" onclick="togglePasswordDialog()">Cancelar</button>

        <!-- Mensaje de error para contraseña incorrecta -->
        <p id="error-message" style="color: red; display: none;">Contraseña incorrecta, intenta de nuevo.</p>
    </div>

    <script>
        // Cargar los componentes del navr y del main de forma independiente
        const components = [
            { id: 'navr', file: 'com/navr.html' }
        ];

        components.forEach(component => {
            fetch(component.file)
                .then(response => response.text())
                .then(html => {
                    document.getElementById(component.id).innerHTML = html;

                    // Añadir eventos para expandir el menú después de cargarlo
                    const navr = document.querySelector('.main-menu');
                    const mainContent = document.getElementById('main-content');

                    navr.addEventListener('mouseenter', function () {
                        navr.classList.add('expanded-menu');
                    });

                    navr.addEventListener('mouseleave', function () {
                        navr.classList.remove('expanded-menu');
                    });
                })
                .catch(error => console.error('Error al cargar componente:', component.id, error));
        });

        // Función para cargar contenido dinámico en el main
        function loadContent(page) {
            fetch(page)
                .then(response => response.text())
                .then(html => {
                    document.getElementById('main-content').innerHTML = html;

                    // Reiniciar Alpine.js después de cargar el contenido
                    Alpine.initTree(document.getElementById('main-content'));
                })
                .catch(error => console.error('Error al cargar página:', page, error));
        };

        // Al iniciar, cargar la página Home por defecto
        document.addEventListener('DOMContentLoaded', function () {
            loadContent('com/home.html');
        });

        // Función para mostrar/ocultar el cuadro de diálogo de ingreso y el overlay
        function togglePasswordDialog() {
            const dialog = document.getElementById('password-dialog');
            const overlay = document.getElementById('overlay');
            
            if (dialog.style.display === 'none' || dialog.style.display === '') {
                dialog.style.display = 'block';
                overlay.style.display = 'block';
            } else {
                dialog.style.display = 'none';
                overlay.style.display = 'none';
            }
        }

        // Función para verificar la contraseña
        function checkPassword() {
            const inputPassword = document.getElementById('password-input').value;

            fetch('private/password.json')  // Reemplazar con la URL correcta del archivo JSON
                .then(response => response.json())
                .then(data => {
                    const correctPassword = data.password;  // El servidor debe devolver { "password": "1111" }

                    if (inputPassword === correctPassword) {
                        goToAddMedia();  // Si la contraseña es correcta, redirigir
                    } else {
                        document.getElementById('error-message').style.display = 'block';  // Mostrar mensaje de error
                    }
                })
                .catch(error => console.error('Error al obtener la contraseña:', error));
        }

        // Función para redirigir a la página de agregar medios
        function goToAddMedia() {
            loadContent('com/addmedia.html');
            togglePasswordDialog();  // Ocultar el cuadro de diálogo después de redirigir
        }
    </script>
</body>

</html>